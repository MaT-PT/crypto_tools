from typing import TypeAlias

import pytest

from libs.ecc_utils import AInvs, Point

CurveWithPoints: TypeAlias = tuple[AInvs, int, Point, Point]
CompositeCurve: TypeAlias = tuple[AInvs, list[int], Point, Point]


@pytest.fixture
def curve_simple2() -> CurveWithPoints:
    a_invs = AInvs((0, 0, 0, 11, 2))
    p = 17
    G = Point(11, 14)
    P = Point(13, 9)
    return a_invs, p, G, P


@pytest.fixture
def curve_simple3() -> CurveWithPoints:
    a_invs = AInvs((0, 9, 0, 3, 5))
    p = 17
    G = Point(2, 2)
    P = Point(6, 11)
    return a_invs, p, G, P


@pytest.fixture
def curve_simple5() -> CurveWithPoints:
    a_invs = AInvs((1, 2, 3, 4, 5))
    p = 17
    G = Point(9, 7)
    P = Point(10, 14)
    return a_invs, p, G, P


@pytest.fixture
def curve_nistp256() -> CurveWithPoints:
    a = 0xFFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC
    b = 0x5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B
    p = 0xFFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF
    G = Point(
        0x6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296,
        0x4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5,
    )
    P = Point(
        87654599616384782261468144539084575745741642173476572116818534813937734962097,
        36148941393881143608132668786672910560318200997860338691667991924250926912277,
    )

    return AInvs((0, 0, 0, a, b)), p, G, P


@pytest.fixture
def curve_composite() -> CompositeCurve:
    p = 190116434441822299465355144611018694747
    q = 227316839687407660649258155239617355023
    U = 18230294945466842193029464818176109628473414458693455272527849780121431872221
    V = 13100009444194791894141652184719316024656527520759416974806280188465496030062
    W = 5543957019331266247602346710470760261172306141315670694208966786894467019982
    G = Point(
        6907136022576092896571634972837671088049787669883537619895520267229978111036,
        35183770197918519490131925119869132666355991678945374923783026655753112300226,
    )
    P = Point(
        14307615146512108428634858855432876073550684773654843931813155864728883306026,
        4017273397399838235912099970694615152686460424982458188724369340441833733921,
    )

    return AInvs((0, U, 0, V, W)), [p, q], G, P
